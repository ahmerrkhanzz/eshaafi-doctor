<div class="card security">
  <div class="loading" *ngIf="loading">
    <img src="../../../../assets/images/loader.gif" alt="" />
  </div>
  <div class="card-header">
    <h4>
      Security
      <small>Update your password</small>
    </h4>
    <div class="card-toolbar">
      <button
        type="button"
        class="btn btn-primary btn-lg mr-2"
        (click)="updateForm()"
        [disabled]="securityForm.invalid"
      >
        Update
      </button>
    </div>
  </div>
  <div class="card-body">
    <div class="row">
      <div class="col-lg-9">
        <form [formGroup]="securityForm">
          <div class="form-group row">
            <label for="" class="col-sm-3 col-form-label"
              >Old Password <span class="text-danger">*</span></label
            >
            <div class="col-sm-9">
              <show-hide-password
                size="lg"
                btnStyle="primary"
                [btnOutline]="false"
              >
                <input
                  pattern="^\S$|^\S[\s\S](?!.* {2})[\s\S]*\S$"
                  type="password"
                  [class.is-invalid]="
                    securityForm.get('old_password').invalid &&
                    (securityForm.get('old_password').dirty ||
                      securityForm.get('old_password').touched)
                  "
                  [class.is-valid]="
                    !securityForm.get('old_password').invalid &&
                    (securityForm.get('old_password').dirty ||
                      securityForm.get('old_password').touched)
                  "
                  minlength="8"
                  maxlength="25"
                  formControlName="old_password"
                  class="form-control form-control-solid form-control-lg"
                />
              </show-hide-password>
              <div
                *ngIf="
                  securityForm.get('old_password').invalid &&
                  (securityForm.get('old_password').dirty ||
                    securityForm.get('old_password').touched)
                "
              >
                <div
                  *ngIf="securityForm.get('old_password').errors.required"
                  class="invalid-feedback"
                >
                  Please provide old password
                </div>
                <div
                  *ngIf="securityForm.get('old_password').errors.minlength"
                  class="invalid-feedback-warning"
                >
                  Minimum length should be 8
                </div>
              </div>
            </div>
          </div>
          <div class="form-group row">
            <label for="" class="col-sm-3 col-form-label"
              >Password <span class="text-danger">*</span></label
            >
            <div class="col-sm-9">
              <show-hide-password
                size="lg"
                btnStyle="primary"
                [btnOutline]="false"
              >
                <input
                  pattern="^\S$|^\S[\s\S](?!.* {2})[\s\S]*\S$"
                  type="password"
                  [class.is-invalid]="
                    securityForm.get('password').invalid &&
                    (securityForm.get('password').dirty ||
                      securityForm.get('password').touched)
                  "
                  [class.is-valid]="
                    !securityForm.get('password').invalid &&
                    (securityForm.get('password').dirty ||
                      securityForm.get('password').touched)
                  "
                  minlength="8"
                  maxlength="25"
                  formControlName="password"
                  class="form-control form-control-solid form-control-lg"
                />
              </show-hide-password>
              <div
                *ngIf="
                  securityForm.get('password').invalid &&
                  (securityForm.get('password').dirty ||
                    securityForm.get('password').touched)
                "
              >
                <div
                  *ngIf="securityForm.get('password').errors.required"
                  class="invalid-feedback"
                >
                  Please provide password
                </div>
                <div
                  *ngIf="securityForm.get('password').errors.minlength"
                  class="invalid-feedback-warning"
                >
                  Minimum length should be 8
                </div>
              </div>
            </div>
          </div>
          <div class="form-group row">
            <label for="" class="col-sm-3 col-form-label"
              >Confirm Password <span class="text-danger">*</span></label
            >
            <div class="col-sm-9">
              <show-hide-password
                size="lg"
                btnStyle="primary"
                [btnOutline]="false"
              >
                <input
                  pattern="^\S$|^\S[\s\S](?!.* {2})[\s\S]*\S$"
                  type="password"
                  [class.is-invalid]="
                    (securityForm.get('confirm_password').invalid &&
                      (securityForm.get('confirm_password').dirty ||
                        securityForm.get('confirm_password').touched)) ||
                    ((securityForm.get('confirm_password').dirty ||
                      securityForm.get('confirm_password').touched) &&
                      securityForm.get('confirm_password').value !==
                        securityForm.get('password').value)
                  "
                  [class.is-valid]="
                    !securityForm.get('confirm_password').invalid &&
                    (securityForm.get('confirm_password').dirty ||
                      securityForm.get('confirm_password').touched) &&
                    securityForm.get('confirm_password').value ===
                      securityForm.get('password').value
                  "
                  minlength="8"
                  maxlength="25"
                  formControlName="confirm_password"
                  class="form-control form-control-solid form-control-lg"
                />
              </show-hide-password>
              <div
                *ngIf="
                  securityForm.get('confirm_password').invalid &&
                  (securityForm.get('confirm_password').dirty ||
                    securityForm.get('confirm_password').touched)
                "
              >
                <div
                  *ngIf="securityForm.get('confirm_password').errors.required"
                  class="invalid-feedback"
                >
                  Please provide confirm password
                </div>
                <div
                  *ngIf="securityForm.get('confirm_password').errors.minlength"
                  class="invalid-feedback-warning"
                >
                  Minimum length should be 8
                </div>
              </div>
              <div
                *ngIf="
                  (securityForm.get('confirm_password').dirty ||
                    securityForm.get('confirm_password').touched) &&
                  securityForm.get('confirm_password').value !==
                    securityForm.get('password').value
                "
                class="invalid-feedback"
              >
                Password doesn't match
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
